<% provide(:title, 'Do test') %>
<div class="row" id="show-test-info" data-id="<%= @test.id %>" 
  data-ready="<%= @test.ready? %>" data-doing="<%= @test.testing? %>" 
  data-is-current-session="<%= current_session_doing_test?(@test) %>">
  <div class="box">
    <div class="col-lg-12">
      <div class="col-md-10 col-md-offset-1 test_user_name">
        <% flash.each do |message_type, message| %>
          <div class="alert alert-<%= message_type %>"><%= message %></div>
        <% end %>
      </div>
      <div class="col-md-12">
        <div class="col-md-offset-1 col-md-6">
          <%= @test.created_at %><br />
          Example result: <%= @test.answers.correct_answer.count %>/
          <%= @test.answers.count %>
        </div>
        <div id='countdown' class="col-md-offset-9"></div>
      </div>
    </div>
    <div class="col-md-12 test_lesson_name">
      <hr>
      <h2><%= @test.lesson.name %></h2>
      <hr>
    </div>
    <div class="col-md-12">
    </div>
    <div class="col-md-6 col-md-offset-3">
      <%= form_for(@test) do |f| %>
        <%= f.hidden_field :status, value: "Submitted", id: "status" %>
        <%= f.hidden_field :user_id, value: @test.user.id %>
        <%= f.hidden_field :lesson_id, value: @test.lesson.id %>
        <%= f.fields_for :answers do |builder| %>
          <%= render 'answer', f: builder %>
        <% end %>
        <%= f.submit "Submit", class: 'btn btn-primary col-md-12', disabled: @test.completed?, id: "submit-button", style: "margin-top: 10px" %>
      <% end %>
    </div>
  </div>
</div>

<%= javascript_include_tag 'show-tests' %>
<script>
  var seconds = <%= @count_down_time %>;
  secondPassed();
  var countdownTimer = setInterval(function(){
    secondPassed();
  }, 1000, false);
  clearIntervals(countdownTimer);
</script>
